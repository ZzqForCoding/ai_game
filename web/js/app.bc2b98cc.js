(function(){"use strict";var e={9007:function(e,t,s){var a=s(9242),l=s(3396),o=s(7139);const r=(0,l._)("div",{class:"aside-header"},[(0,l._)("svg",{t:"1660362934898",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1502",width:"25",height:"25"},[(0,l._)("path",{d:"M661.333333 490.666667c-36.266667 0-64 27.733333-64 64s27.733333 64 64 64 64-27.733333 64-64-27.733333-64-64-64M362.666667 490.666667c-36.266667 0-64 27.733333-64 64s27.733333 64 64 64 64-27.733333 64-64-27.733333-64-64-64",fill:"#2F3CF4","p-id":"1503"}),(0,l._)("path",{d:"M128 320c0-23.466667 19.2-42.666667 42.666667-42.666667h170.666666l-61.866666-155.733333c-8.533333-21.333333 2.133333-46.933333 23.466666-55.466667 21.333333-8.533333 46.933333 2.133333 55.466667 23.466667l74.666667 185.6h155.733333l74.666667-185.6c8.533333-21.333333 34.133333-32 55.466666-23.466667 21.333333 8.533333 32 34.133333 23.466667 55.466667L682.666667 277.333333h170.666666c23.466667 0 42.666667 19.2 42.666667 42.666667v597.333333c0 23.466667-19.2 42.666667-42.666667 42.666667H170.666667c-23.466667 0-42.666667-19.2-42.666667-42.666667V320z m85.333333 42.666667v512h597.333334V362.666667H213.333333zM1024 725.333333V512c0-23.466667-19.2-42.666667-42.666667-42.666667s-42.666667 19.2-42.666666 42.666667v213.333333c0 23.466667 19.2 42.666667 42.666666 42.666667s42.666667-19.2 42.666667-42.666667M42.666667 768c23.466667 0 42.666667-19.2 42.666666-42.666667V512c0-23.466667-19.2-42.666667-42.666666-42.666667s-42.666667 19.2-42.666667 42.666667v213.333333c0 23.466667 19.2 42.666667 42.666667 42.666667",fill:"#2F3CF4","p-id":"1504"})]),(0,l._)("span",{style:{"margin-left":"5px"}},"King Of Bots")],-1),n=(0,l._)("span",null,"Apps",-1),i=(0,l.Uk)("敬请期待..."),c=(0,l.Uk)("首页"),u=(0,l.Uk)("排行榜"),d=(0,l.Uk)("讨论区"),m=(0,l.Uk)("留言板"),p={class:"current-page"},h=(0,l._)("div",{class:"flex-grow"},null,-1),g={class:"el-dropdown-link"},f={class:"username"},_=(0,l.Uk)("我的Bot"),w=(0,l.Uk)("退出"),y=(0,l._)("span",null," 登录 ",-1),v=(0,l._)("span",null," 注册 ",-1),b=(0,l._)("div",{class:"footer"},null,-1),k=(0,l._)("div",{class:"footer-icon"},[(0,l._)("svg",{t:"1660657940962",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3310",width:"25",height:"25"},[(0,l._)("path",{d:"M512 0C229.248 0 0 229.248 0 512s229.248 512 512 512 512-229.248 512-512S794.752 0 512 0z m0 896c-212.032 0-384-171.968-384-384S299.968 128 512 128s384 171.968 384 384-171.968 384-384 384z m94.08-513.408L512 192.064l-94.016 190.528-210.304 30.592 152.192 148.288-35.968 209.344L512 672l188.032 98.88-35.904-209.344 152.128-148.288-210.176-30.656z",fill:"#ffffff","p-id":"3311"})])],-1);function W(e,t,s,a,W,x){const C=(0,l.up)("Grid"),S=(0,l.up)("el-icon"),z=(0,l.up)("el-menu-item"),V=(0,l.up)("el-menu-item-group"),I=(0,l.up)("el-sub-menu"),U=(0,l.up)("HomeFilled"),j=(0,l.up)("router-link"),L=(0,l.up)("DataLine"),M=(0,l.up)("Comment"),B=(0,l.up)("Edit"),q=(0,l.up)("Expand"),D=(0,l.up)("Fold"),F=(0,l.up)("el-button"),O=(0,l.up)("el-scrollbar"),P=(0,l.up)("el-menu"),H=(0,l.up)("el-aside"),E=(0,l.up)("el-avatar"),A=(0,l.up)("arrow-down"),$=(0,l.up)("el-dropdown-item"),G=(0,l.up)("el-dropdown-menu"),R=(0,l.up)("el-dropdown"),T=(0,l.up)("el-header"),Z=(0,l.up)("router-view"),N=(0,l.up)("el-main"),K=(0,l.up)("el-footer"),J=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(J,null,{default:(0,l.w5)((()=>[(0,l.Wm)(H,{width:"200px",style:{"user-select":"none"}},{default:(0,l.w5)((()=>[r,(0,l.Wm)(P,{class:"el-aside-menu","background-color":"rgb(13,66,118)","text-color":"#CCCCCC","active-text-color":"#fff",collapse:a.isCollapse},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{class:"aside-scrollbar"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{index:"1"},{title:(0,l.w5)((()=>[(0,l.Wm)(S,{size:30},{default:(0,l.w5)((()=>[(0,l.Wm)(C)])),_:1}),n])),default:(0,l.w5)((()=>[(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(z,{index:"1-3",disabled:""},{default:(0,l.w5)((()=>[i])),_:1})])),_:1})])),_:1}),(0,l.Wm)(j,{class:"link-text",to:{name:"record_index"}},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{index:"2"},{title:(0,l.w5)((()=>[c])),default:(0,l.w5)((()=>[(0,l.Wm)(S,{size:30},{default:(0,l.w5)((()=>[(0,l.Wm)(U)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(j,{class:"link-text",to:{name:"ranklist_index"}},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{index:"3"},{title:(0,l.w5)((()=>[u])),default:(0,l.w5)((()=>[(0,l.Wm)(S,{size:30},{default:(0,l.w5)((()=>[(0,l.Wm)(L)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(j,{class:"link-text",to:{name:"discussion_index"}},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{index:"4"},{title:(0,l.w5)((()=>[d])),default:(0,l.w5)((()=>[(0,l.Wm)(S,{size:30},{default:(0,l.w5)((()=>[(0,l.Wm)(M)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(j,{class:"link-text",to:{name:"message_board_index"}},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{index:"5"},{title:(0,l.w5)((()=>[m])),default:(0,l.w5)((()=>[(0,l.Wm)(S,{size:30},{default:(0,l.w5)((()=>[(0,l.Wm)(B)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(F,{onClick:a.collapse,circle:"",class:"collapse-btn",color:"#626aef"},{default:(0,l.w5)((()=>[a.isCollapse?((0,l.wg)(),(0,l.j4)(S,{key:0,size:17},{default:(0,l.w5)((()=>[(0,l.Wm)(q)])),_:1})):((0,l.wg)(),(0,l.j4)(S,{key:1,size:17},{default:(0,l.w5)((()=>[(0,l.Wm)(D)])),_:1}))])),_:1},8,["onClick"])])),_:1})])),_:1},8,["collapse"])])),_:1}),(0,l.Wm)(J,null,{default:(0,l.w5)((()=>[(0,l.Wm)(T,{style:{"user-select":"none"}},{default:(0,l.w5)((()=>[(0,l.Wm)(P,{"default-active":e.activeIndex,class:"el-menu-demo",mode:"horizontal",ellipsis:!1,onSelect:e.handleSelect},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,o.zw)(a.page),1),h,e.$store.state.user.is_login?((0,l.wg)(),(0,l.j4)(z,{key:0,index:"1",style:{"margin-right":"20px",height:"60px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(R,null,{dropdown:(0,l.w5)((()=>[(0,l.Wm)(G,{style:{"user-select":"none"}},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{class:"link-text",to:{name:"user_bot_index"}},{default:(0,l.w5)((()=>[(0,l.Wm)($,null,{default:(0,l.w5)((()=>[_])),_:1})])),_:1}),(0,l.Wm)($,{divided:"",onClick:a.logout},{default:(0,l.w5)((()=>[w])),_:1},8,["onClick"])])),_:1})])),default:(0,l.w5)((()=>[(0,l._)("span",g,[(0,l.Wm)(E,{shape:"square",size:50,src:e.$store.state.user.photo,style:{"margin-right":"15px"}},null,8,["src"]),(0,l._)("span",f,(0,o.zw)(e.$store.state.user.username),1),(0,l.Wm)(S,{class:"el-icon--right"},{default:(0,l.w5)((()=>[(0,l.Wm)(A)])),_:1})])])),_:1})])),_:1})):(0,l.kq)("",!0),e.$store.state.user.is_login||e.$store.state.user.pulling_info?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(j,{key:1,class:"link-text",to:{name:"user_account_login"}},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{index:"1"},{default:(0,l.w5)((()=>[y])),_:1})])),_:1})),e.$store.state.user.is_login||e.$store.state.user.pulling_info?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(j,{key:2,class:"link-text",to:{name:"user_account_register"}},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{index:"2"},{default:(0,l.w5)((()=>[v])),_:1})])),_:1}))])),_:1},8,["default-active","onSelect"])])),_:1}),(0,l.Wm)(N,null,{default:(0,l.w5)((()=>[(0,l.Wm)(O,{class:"main-scrollbar"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z)])),_:1})])),_:1}),(0,l.Wm)(K,null,{default:(0,l.w5)((()=>[b,k])),_:1})])),_:1})])),_:1})}var x=s(65),C=s(2483);const S=e=>((0,l.dD)("data-v-cd3478ec"),e=e(),(0,l.Cn)(),e),z=S((()=>(0,l._)("div",{class:"card-header"},[(0,l._)("span",null,"公共聊天区")],-1))),V={class:"username"},I={class:"main"},U=(0,l.Uk)("发送");function j(e,t,s,r,n,i){const c=(0,l.up)("PlayGround"),u=(0,l.up)("MatchGround"),d=(0,l.up)("el-col"),m=(0,l.up)("el-avatar"),p=(0,l.up)("el-button"),h=(0,l.up)("el-scrollbar"),g=(0,l.up)("el-card"),f=(0,l.up)("el-input"),_=(0,l.up)("el-form"),w=(0,l.up)("el-row");return(0,l.wg)(),(0,l.j4)(w,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{span:14,offset:2},{default:(0,l.w5)((()=>["playing"===e.$store.state.pk.status?((0,l.wg)(),(0,l.j4)(c,{key:0,game:r.game},null,8,["game"])):(0,l.kq)("",!0),"matching"===e.$store.state.pk.status?((0,l.wg)(),(0,l.j4)(u,{key:1,operate:r.operate,botId:r.botId},null,8,["operate","botId"])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(d,{span:5,offset:1,style:{"margin-top":"40px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"message",style:{"user-select":"none"}},{header:(0,l.w5)((()=>[z])),default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"messages",shadow:"never"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{"max-height":"320px",ref:"msgScroll"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.$store.state.pk.msgs,(t=>((0,l.wg)(),(0,l.iD)("div",{class:"message-content",key:t.id},[(0,l._)("div",V,(0,o.zw)(t.username),1),(0,l._)("div",I,[(0,l.Wm)(m,{class:"photo",size:"small",src:t.photo},null,8,["src"]),(0,l.Wm)(p,{round:"",type:e.$store.state.user.username===t.username?"primary":""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(t.text),1)])),_:2},1032,["type"])])])))),128))])),_:1},512)])),_:1}),(0,l.Wm)(g,{class:"message-send",shadow:"never"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{onSubmit:t[1]||(t[1]=(0,a.iM)((()=>{}),["prevent"]))},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{class:"message-input",autosize:{minRows:6,maxRows:6},type:"textarea",placeholder:"Please input message...",modelValue:r.message,"onUpdate:modelValue":t[0]||(t[0]=e=>r.message=e),resize:"none",onKeydown:(0,a.D2)(r.enterSendMsg,["enter"])},null,8,["modelValue","onKeydown"]),(0,l.Wm)(p,{class:"sendBtn",type:"primary",onClick:r.sendMsg,size:"small"},{default:(0,l.w5)((()=>[U])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}const L={class:"playground"};function M(e,t,s,a,o,r){const n=(0,l.up)("GameMap");return(0,l.wg)(),(0,l.iD)("div",L,[(0,l.Wm)(n,{game:s.game},null,8,["game"])])}const B={class:"gamemap",ref:"parent"};function q(e,t,s,o,r,n){const i=(0,l.up)("ResultBoard");return(0,l.wg)(),(0,l.iD)("div",B,[(0,l._)("canvas",{ref:"canvas",tabindex:"0",onContextmenu:t[0]||(t[0]=(0,a.iM)((()=>{}),["prevent"])),style:{height:"100%"}},null,544),"none"!=e.$store.state.pk.loser?((0,l.wg)(),(0,l.j4)(i,{key:0})):(0,l.kq)("",!0)],512)}var D=s(4870);const F=e=>((0,l.dD)("data-v-280e6f5e"),e=e(),(0,l.Cn)(),e),O={class:"result-board",style:{"user-select":"none"}},P={key:0,class:"all"},H={class:"user-profile"},E=["src"],A={class:"username"},$=F((()=>(0,l._)("span",{class:"user-state"}," 平 ",-1))),G={class:"user-profile"},R=["src"],T={class:"username"},Z={key:1,class:"lose"},N={class:"user-profile"},K=["src"],J={class:"username"},Y=F((()=>(0,l._)("span",{class:"user-state"}," 输 ",-1))),X={key:2,class:"win"},Q={class:"user-profile"},ee=["src"],te={class:"username"},se=F((()=>(0,l._)("span",{class:"user-state"}," 赢 ",-1))),ae={style:{"text-align":"center"}},le=(0,l.Uk)("再来一局"),oe=(0,l.Uk)("回到主页");function re(e,t,s,a,r,n){const i=(0,l.up)("el-button");return(0,l.wg)(),(0,l.iD)("div",O,["all"===e.$store.state.pk.loser?((0,l.wg)(),(0,l.iD)("div",P,[(0,l._)("div",H,[(0,l._)("img",{src:e.$store.state.user.photo,alt:""},null,8,E),(0,l._)("span",A,(0,o.zw)(e.$store.state.user.username),1)]),$,(0,l._)("div",G,[(0,l._)("img",{src:e.$store.state.pk.opponent_photo,alt:""},null,8,R),(0,l._)("span",T,(0,o.zw)(e.$store.state.pk.opponent_username),1)])])):"A"===e.$store.state.pk.loser&&e.$store.state.pk.a_id===parseInt(e.$store.state.user.id)||"B"===e.$store.state.pk.loser&&e.$store.state.pk.b_id===parseInt(e.$store.state.user.id)?((0,l.wg)(),(0,l.iD)("div",Z,[(0,l._)("div",N,[(0,l._)("img",{src:e.$store.state.user.photo,alt:""},null,8,K),(0,l._)("span",J,(0,o.zw)(e.$store.state.user.username),1)]),Y])):((0,l.wg)(),(0,l.iD)("div",X,[(0,l._)("div",Q,[(0,l._)("img",{src:e.$store.state.user.photo,alt:""},null,8,ee),(0,l._)("span",te,(0,o.zw)(e.$store.state.user.username),1)]),se])),(0,l._)("div",ae,[(0,l.Wm)(i,{color:"rgb(255, 193, 7)",round:"",onClick:a.restart,class:"btn"},{default:(0,l.w5)((()=>[le])),_:1},8,["onClick"]),(0,l.Wm)(i,{round:"",onClick:a.back,class:"btn"},{default:(0,l.w5)((()=>[oe])),_:1},8,["onClick"])])])}var ne={name:"ResultBoard",setup(){const e=(0,x.oR)(),t=()=>{e.commit("updateStatus","matching"),e.commit("updateGameResult",{loser:"none",status:"none"}),e.commit("updateOpponent",{username:"我的对手",photo:"https://cdn.acwing.com/media/article/image/2022/08/09/1_1db2488f17-anonymous.png"}),e.commit("clearMsg"),e.commit("updateCanSendMsg",!1)},s=()=>{qa.push({name:"record_index"}),e.commit("updateStatus","matching"),e.commit("updateGameResult",{loser:"none",status:"none"}),e.commit("updateOpponent",{username:"我的对手",photo:"https://cdn.acwing.com/media/article/image/2022/08/09/1_1db2488f17-anonymous.png"}),e.commit("clearMsg"),e.commit("updateCanSendMsg",!1)};return{restart:t,back:s}}},ie=s(89);const ce=(0,ie.Z)(ne,[["render",re],["__scopeId","data-v-280e6f5e"]]);var ue=ce;const de=[];class me{constructor(){de.push(this),this.has_called_start=!1,this.timedelta=0,this.uuid=this.create_uuid()}create_uuid(){let e="";for(let t=0;t<8;t++){let t=parseInt(Math.floor(10*Math.random()));e+=t}return e}start(){}update(){}on_destroy(){}destroy(){this.on_destroy();for(let e in de){const t=de[e];if(t.uuid===this.uuid){de.splice(e,1);break}}}}let pe;const he=e=>{for(let t of de)t.has_called_start?(t.timedelta=e-pe,t.update()):(t.has_called_start=!0,t.start());pe=e,requestAnimationFrame(he)};requestAnimationFrame(he);class ge extends me{constructor(e,t,s){super(),this.r=e,this.c=t,this.gamemap=s,this.color="#B37226"}update(){this.render()}render(){const e=this.gamemap.L,t=this.gamemap.ctx;t.fillStyle=this.color,t.fillRect(this.c*e,this.r*e,e,e)}}class fe{constructor(e,t){this.r=e,this.c=t,this.x=t+.5,this.y=e+.5}}class _e extends me{constructor(e,t){super(),this.id=e.id,this.color=e.color,this.gamemap=t,this.cells=[new fe(e.r,e.c)],this.next_cell=null,this.speed=5,this.direction=-1,this.status="idle",this.dr=[-1,0,1,0],this.dc=[0,1,0,-1],this.step=0,this.eps=.01,this.eye_direction=0,1===this.id&&(this.eye_direction=2),this.eye_dx=[[-1,1],[1,1],[1,-1],[-1,-1]],this.eye_dy=[[-1,-1],[-1,1],[1,1],[-1,1]]}start(){}set_direction(e){this.direction=e}check_tail_increasing(){return this.step<=10||this.step%3==1}next_step(){const e=this.direction;this.next_cell=new fe(this.cells[0].r+this.dr[e],this.cells[0].c+this.dc[e]),this.eye_direction=e,this.direction=-1,this.status="move",this.step++;const t=this.cells.length;for(let s=t;s>0;s--)this.cells[s]=JSON.parse(JSON.stringify(this.cells[s-1]))}update_move(){const e=this.next_cell.x-this.cells[0].x,t=this.next_cell.y-this.cells[0].y,s=Math.sqrt(e*e+t*t);if(s<this.eps)this.cells[0]=this.next_cell,this.next_cell=null,this.status="idle",this.check_tail_increasing()||this.cells.pop();else{const a=this.speed*this.timedelta/1e3;if(this.cells[0].x+=a*e/s,this.cells[0].y+=a*t/s,!this.check_tail_increasing()){const e=this.cells.length,t=this.cells[e-1],l=this.cells[e-2],o=l.x-t.x,r=l.y-t.y;t.x+=a*o/s,t.y+=a*r/s}}}update(){"move"===this.status&&this.update_move(),this.render()}render(){const e=this.gamemap.L,t=this.gamemap.ctx;t.fillStyle=this.color,"die"===this.status&&(t.fillStyle="white");for(const s of this.cells)t.beginPath(),t.arc(s.x*e,s.y*e,e/2*.8,0,2*Math.PI),t.fill();for(let s=1;s<this.cells.length;s++){const a=this.cells[s-1],l=this.cells[s];Math.abs(a.x-l.x)<this.eps&&Math.abs(a.y-l.y)<this.eps||(Math.abs(a.x-l.x)<this.eps?t.fillRect((a.x-.5+.1)*e,Math.min(a.y,l.y)*e,.8*e,Math.abs(a.y-l.y)*e):t.fillRect(Math.min(a.x,l.x)*e,(a.y-.5+.1)*e,Math.abs(a.x-l.x)*e,.8*e))}t.fillStyle="black";for(let s=0;s<2;s++){const a=(this.cells[0].x+.15*this.eye_dx[this.eye_direction][s])*e,l=(this.cells[0].y+.15*this.eye_dy[this.eye_direction][s])*e;t.beginPath(),t.arc(a,l,.05*e,0,2*Math.PI),t.fill()}}}class we extends me{constructor(e,t,s){super(),this.ctx=e,this.parent=t,this.store=s,this.L=0,this.rows=13,this.cols=14,this.inner_walls_count=20,this.walls=[]}create_walls(){const e=this.store.state.pk.gamemap;for(let t=0;t<this.rows;t++)for(let s=0;s<this.cols;s++)e[t][s]&&this.walls.push(new ge(t,s,this))}start(){this.create_walls();let e=0,t=0;this.store.state.pk.a_id==this.store.state.user.id?(e="#4876EC",t="#F94848"):(e="#F94848",t="#4876EC"),this.snakes=[new _e({id:0,color:e,r:this.rows-2,c:1},this),new _e({id:1,color:t,r:1,c:this.cols-2},this)],this.add_listening_events()}transDir(e){return e<=1?e+=2:e-=2,e}add_listening_events(){if(this.store.state.record.is_record){let e=0;const t=this.store.state.record.a_steps,s=this.store.state.record.b_steps,a=this.store.state.record.record_loser,[l,o]=this.snakes,r=setInterval((()=>{e>=t.length-1?("all"!==a&&"A"!==a||(l.status="die"),"all"!==a&&"B"!==a||(o.status="die"),clearInterval(r)):(e<t.length&&l.set_direction(parseInt(t[e])),e<s.length&&o.set_direction(parseInt(s[e]))),e++}),300)}else this.ctx.canvas.focus(),this.ctx.canvas.addEventListener("keydown",(e=>{let t=-1;"w"===e.key?t=0:"d"===e.key?t=1:"s"===e.key?t=2:"a"===e.key&&(t=3),this.store.state.user.id!==this.store.state.pk.a_id&&(t=this.transDir(t)),t>=0&&this.store.state.pk.socket.send(JSON.stringify({event:"move",direction:t}))}))}update_size(){this.L=parseInt(Math.min(this.parent.clientWidth/this.cols,this.parent.clientHeight/this.rows)),this.ctx.canvas.width=this.L*this.cols,this.ctx.canvas.height=this.L*this.rows}check_ready(){for(const e of this.snakes){if("idle"!==e.status)return!1;if(-1===e.direction)return!1}return!0}next_step(){for(const e of this.snakes)e.next_step()}check_valid(e){for(const t of this.walls)if(t.r===e.r&&t.c===e.c)return!1;for(const t of this.snakes){let s=t.cells.length;t.check_tail_increasing()||s--;for(let a=0;a<s;a++)if(t.cells[a].r===e.r&&t.cells[a].c===e.c)return!1}return!0}update(){this.update_size(),this.check_ready()&&this.next_step(),this.render()}render(){const e="#AAD751",t="#A2D149";for(let s=0;s<this.rows;s++)for(let a=0;a<this.cols;a++)this.ctx.fillStyle=(s+a)%2==0?e:t,this.ctx.fillRect(a*this.L,s*this.L,this.L,this.L)}}class ye extends me{constructor(e){super(),this.gamemap=e,this.text="即将开始：3",this.time=3}start(){}update(){this.render(),"waiting"===this.gamemap.status&&(this.time-=this.timedelta/1e3,this.write("即将开始："+parseInt(this.time))),this.time<=0&&(this.gamemap.status="black",this.destroy())}write(e){this.text=e}render(){const e=this.gamemap.L,t=this.gamemap.ctx;t.font="13px serif",t.fillStyle="black",t.textAlign="center",t.fillText(this.text,this.gamemap.cols/2*e,15)}}class ve extends me{constructor(e,t){super(),this.gamemap=e,this.color=t.color,this.r=t.r,this.c=t.c}update(){this.render()}render(){const e=this.gamemap.L,t=this.gamemap.ctx;t.fillStyle=this.color,t.beginPath(),t.arc(this.r*e,this.c*e,.4*e,0,2*Math.PI),t.fill()}}class be extends me{constructor(e,t,s,a){super(),this.gamemap=e,this.color=t,this.username=s,this.photo=a}start(){this.add_listening_events()}add_listening_events(){this.gamemap.ctx.canvas.addEventListener("click",(e=>{if(this.gamemap.status!==this.color)return;const t=this.gamemap.ctx.canvas.getBoundingClientRect();let s=(e.clientX-t.left)/this.gamemap.L,a=(e.clientY-t.top)/this.gamemap.L,l=Math.round(s),o=Math.round(a);if(!this.gamemap.pre_judge(l,o))return;let r=new ve(this.gamemap,{color:this.color,r:l,c:o});this.gamemap.currentChess=r,this.gamemap.chesses.push(r),this.gamemap.judge()}))}}class ke extends me{constructor(e,t){super(),this.ctx=e,this.parent=t,this.rows=17,this.cols=17,this.points=[{x:4,y:4},{x:this.rows-4,y:4},{x:4,y:this.cols-4},{x:this.rows-4,y:this.cols-4}],this.chesses=[],this.preStatus="",this.status="waiting",this.currentChess=null,this.winChesses=[]}start(){new ye(this),new be(this,"white","zzq","https://cdn.acwing.com/media/user/profile/photo/29231_lg_3e166b549d.jpg"),new be(this,"black","zzq","https://cdn.acwing.com/media/user/profile/photo/29231_lg_3e166b549d.jpg")}update_size(){this.L=parseInt(Math.min(this.parent.clientWidth/this.cols,this.parent.clientHeight/this.rows)),this.ctx.canvas.width=this.L*this.cols,this.ctx.canvas.height=this.L*this.rows}update(){this.update_size(),this.render()}pre_judge(e,t){if(e<1||e>this.rows-1||t<1||t>this.cols-1)return!1;for(let s=0;s<this.chesses.length;s++)if(this.chesses[s].r===e&&this.chesses[s].c===t)return!1;return!0}get_chess(e,t){for(let s of this.chesses)if(s.r===e&&s.c===t&&this.preStatus===s.color)return s;return null}judge(){this.preStatus=this.status,this.status="judge";let e=this.currentChess.r,t=this.currentChess.c,s=0,a=0,l=0,o=0,r=0,n=0,i=0,c=0,u=e,d=t-1;while(this.get_chess(u,d))s++,d--;u=e-1,d=t-1;while(this.get_chess(u,d))a++,u--,d--;u=e-1,d=t;while(this.get_chess(u,d))l++,u--;u=e-1,d=t+1;while(this.get_chess(u,d))o++,u--,d++;u=e,d=t+1;while(this.get_chess(u,d))r++,d++;u=e+1,d=t+1;while(this.get_chess(u,d))n++,u++,d++;u=e+1,d=t;while(this.get_chess(u,d))i++,u++;u=e+1,d=t-1;while(this.get_chess(u,d))c++,u++,d--;if(4===s){for(let s=t-4;s<=t;s++)this.winChesses.push(this.get_chess(e,s));return this.currentChess=null,!1}if(4===a){for(let s=e-4,a=t-4;s<=e;s++,a++)this.winChesses.push(this.get_chess(s,a));return this.currentChess=null,!1}if(4===l){for(let s=e-4;s<=e;s++)this.winChesses.push(this.get_chess(s,t));return this.currentChess=null,!1}if(4===o){for(let s=e-4,a=t+4;s<=e;s++,a--)this.winChesses.push(this.get_chess(s,a));return this.currentChess=null,!1}if(4===r){for(let s=t;s<=t+4;s++)this.winChesses.push(this.get_chess(e,s));return this.currentChess=null,!1}if(4===n){for(let s=e,a=t;s<=e+4;s++,a++)this.winChesses.push(this.get_chess(s,a));return this.currentChess=null,!1}if(4===i){for(let s=e;s<=e+4;s++)this.winChesses.push(this.get_chess(s,t));return this.currentChess=null,!1}if(4===c){for(let s=e+4,a=t-4;s>=e;s--,a++)this.winChesses.push(this.get_chess(s,a));return this.currentChess=null,!1}if(s+r===4){for(let a=t-s;a<=t+r;a++)this.winChesses.push(this.get_chess(e,a));return this.currentChess=null,!1}if(l+i===4){for(let s=e-l;s<=e+i;s++)this.winChesses.push(this.get_chess(s,t));return this.currentChess=null,!1}if(a+n===4){for(let s=e-a,l=t-a;s<=e+a;s++,l++)this.winChesses.push(this.get_chess(s,l));return this.currentChess=null,!1}if(o+c===4){for(let s=e-o,a=t+o;s<=e+c;s++,a--)this.winChesses.push(this.get_chess(s,a));return this.currentChess=null,!1}setTimeout((()=>{"black"===this.preStatus?this.status="white":"white"===this.preStatus&&(this.status="black")}),500)}render(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.cols;t++)this.ctx.fillStyle="rgb(249,215,87)",this.ctx.fillRect(t*this.L,e*this.L,this.L,this.L),e>=1&&t>=1&&e<this.rows-1&&t<this.cols-1&&(this.ctx.strokeStyle="black",this.ctx.strokeRect(t*this.L,e*this.L,this.L,this.L));for(let e=0;e<this.points.length;e++)this.ctx.fillStyle="black",this.ctx.beginPath(),this.ctx.arc(this.points[e].x*this.L,this.points[e].y*this.L,.1*this.L,0,2*Math.PI),this.ctx.fill();null!==this.currentChess&&(this.ctx.beginPath(),this.ctx.arc(this.currentChess.r*this.L,this.currentChess.c*this.L,.4*this.L,0,2*Math.PI),this.ctx.strokeStyle="red",this.ctx.lineWidth=.1*this.L,this.ctx.stroke());for(let e of this.winChesses)this.ctx.beginPath(),this.ctx.arc(e.r*this.L,e.c*this.L,.4*this.L,0,2*Math.PI),this.ctx.strokeStyle="red",this.ctx.lineWidth=.1*this.L,this.ctx.stroke()}}var We={name:"GameMap",components:{ResultBoard:ue},props:{game:{type:Number,required:!0}},setup(e){const t=(0,x.oR)();let s=(0,D.iH)(null),a=(0,D.iH)(null);return(0,l.bv)((()=>{t.commit("updateGameResult",{loser:"none",status:"none"}),2===e.game?t.commit("updateGameObject",new we(a.value.getContext("2d"),s.value,t)):1===e.game&&new ke(a.value.getContext("2d"),s.value)})),{parent:s,canvas:a}}};const xe=(0,ie.Z)(We,[["render",q],["__scopeId","data-v-45381f3e"]]);var Ce=xe,Se={name:"PlayGround",components:{GameMap:Ce},props:{game:{type:String,required:!0}},setup(){const e=(0,x.oR)();(0,l.Ah)((()=>{e.commit("updateCanSendMsg",!1)}))}};const ze=(0,ie.Z)(Se,[["render",M],["__scopeId","data-v-77caba2a"]]);var Ve=ze;const Ie={class:"user-photo"},Ue=["src"],je={class:"user-username"},Le={class:"user-photo"},Me=["src"],Be={class:"user-username"};function qe(e,t,s,a,r,n){const i=(0,l.up)("el-col"),c=(0,l.up)("el-button"),u=(0,l.up)("el-row");return(0,l.wg)(),(0,l.j4)(u,{style:{"margin-top":"20px","user-select":"none"}},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{span:9,offset:2},{default:(0,l.w5)((()=>[(0,l._)("div",Ie,[(0,l._)("img",{src:e.$store.state.user.photo,alt:""},null,8,Ue)]),(0,l._)("div",je,(0,o.zw)(e.$store.state.user.username),1)])),_:1}),(0,l.Wm)(i,{span:9,offset:2},{default:(0,l.w5)((()=>[(0,l._)("div",Le,[(0,l._)("img",{src:e.$store.state.pk.opponent_photo,alt:""},null,8,Me)]),(0,l._)("div",Be,(0,o.zw)(e.$store.state.pk.opponent_username),1)])),_:1}),(0,l.Wm)(i,{span:2,offset:11,style:{"margin-top":"30px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{round:"",class:"match_btn",onClick:a.click_match},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(a.match_btn_info),1)])),_:1},8,["onClick"])])),_:1})])),_:1})}var De={name:"MatchGround",props:{operate:{type:Number,required:!0},botId:{type:Number,required:!0}},setup(e){const t=(0,x.oR)();let s=(0,D.iH)("开始匹配");const a=()=>{"开始匹配"===s.value?(s.value="取消匹配",t.state.pk.socket.send(JSON.stringify({event:"start_match",username:t.state.user.username,photo:t.state.user.photo,operate:e.operate,botId:e.botId}))):(s.value="开始匹配",t.state.pk.socket.send(JSON.stringify({event:"stop_match",username:t.state.user.username,photo:t.state.user.photo,operate:e.operate,botId:e.botId})))};return{match_btn_info:s,click_match:a}}};const Fe=(0,ie.Z)(De,[["render",qe],["__scopeId","data-v-d3197f62"]]);var Oe=Fe,Pe={name:"PkIndexView",components:{PlayGround:Ve,MatchGround:Oe},setup(){const e=(0,C.yj)(),t=(0,x.oR)(),s=parseInt(e.params.game),a=e.query.operate,o=e.query.bot_id,r="wss://aigame.zzqahm.top/wss/multiplayer/snake/?token="+t.state.user.access;let n=(0,D.iH)(""),i=(0,D.iH)(null);t.commit("updateGameResult",{loser:"none",status:"none"}),t.commit("updateOpponent",{username:"我的对手",photo:"https://cdn.acwing.com/media/article/image/2022/08/09/1_1db2488f17-anonymous.png"}),t.commit("updateIsRecord",!1);let c=null;2===s&&((0,l.bv)((()=>{t.commit("clearMsg"),c=new WebSocket(r),c.onopen=()=>{console.log("connected!"),t.commit("updateSocket",c)};const e=e=>(e<=1?e+=2:e-=2,e);c.onmessage=s=>{const a=JSON.parse(s.data);if(a.username!==t.state.user.username)if("start_game"===a.event)t.commit("updateOpponent",{username:a.username,photo:a.photo}),t.commit("updateGame",a.game),t.commit("updateCanSendMsg",!0),setTimeout((()=>{t.commit("updateStatus","playing")}),2e3);else if("move"===a.event){const s=t.state.pk.gameObject,[l,o]=s.snakes;t.state.user.id===t.state.pk.a_id?(l.set_direction(a.a_direction),o.set_direction(a.b_direction)):(l.set_direction(e(a.b_direction)),o.set_direction(e(a.a_direction)))}else if("result"===a.event){const e=t.state.pk.gameObject,[s,l]=e.snakes;"all"===a.loser?(s.status="die",l.status="die"):"A"===a.loser&&t.state.user.id===t.state.pk.a_id||"B"===a.loser&&t.state.user.id===t.state.pk.b_id?s.status="die":("A"===a.loser&&t.state.user.id===t.state.pk.b_id||"B"===a.loser&&t.state.user.id===t.state.pk.a_id)&&(l.status="die"),t.commit("updateGameResult",{loser:a.loser,status:a.status})}else if("pk_message"===a.event){if(!t.state.pk.canSendMsg)return;t.commit("pushMsg",a.msg),a.msg.username===t.state.user.username&&(t.commit("updateCanSendMsg",!1),setTimeout((()=>{t.commit("updateCanSendMsg",!0)}),1500))}},c.onclose=()=>{console.log("disconnected!")}})),(0,l.Ah)((()=>{c.close(),t.commit("updateStatus","matching")})));const u=()=>{t.state.pk.canSendMsg&&""!==n.value&&(t.state.pk.socket.send(JSON.stringify({event:"pk_message",username:t.state.user.username,photo:t.state.user.photo,text:n.value})),n.value="")},d=e=>{e.ctrlKey&&13===e.keyCode?n.value+="\n":(e.preventDefault(),u())};return{game:s,operate:a,botId:o,message:n,sendMsg:u,enterSendMsg:d,msgScroll:i}}};const He=(0,ie.Z)(Pe,[["render",j],["__scopeId","data-v-cd3478ec"]]);var Ee=He;const Ae=e=>((0,l.dD)("data-v-0bc3a85c"),e=e(),(0,l.Cn)(),e),$e=Ae((()=>(0,l._)("div",{class:"card-header"},[(0,l._)("span",{class:"ranklist-title"},"天梯分排行榜")],-1))),Ge={class:"userinfo"},Re={class:"player-card-username"},Te={class:"ranklist-username"};function Ze(e,t,s,a,r,n){const i=(0,l.up)("el-avatar"),c=(0,l.up)("el-link"),u=(0,l.up)("el-table-column"),d=(0,l.up)("el-table"),m=(0,l.up)("el-card"),p=(0,l.up)("el-pagination"),h=(0,l.up)("el-col"),g=(0,l.up)("el-row");return(0,l.wg)(),(0,l.j4)(g,{style:{"margin-top":"40px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{span:14,offset:5},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{style:{"margin-top":"25px","user-select":"none"}},{header:(0,l.w5)((()=>[$e])),default:(0,l.w5)((()=>[(0,l.Wm)(d,{data:a.players,style:{width:"100%"},"highlight-current-row":"","max-height":"720","table-layout":"auto"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{label:"玩家",align:"center"},{default:(0,l.w5)((e=>[(0,l._)("div",Ge,[(0,l.Wm)(i,{shape:"square",size:"small",src:e.row.photo},null,8,["src"]),(0,l._)("span",Re,[(0,l.Wm)(c,{type:"primary"},{default:(0,l.w5)((()=>[(0,l._)("span",Te,(0,o.zw)(e.row.username),1)])),_:2},1024)])])])),_:1}),(0,l.Wm)(u,{prop:"rating",label:"游戏",align:"center"})])),_:1},8,["data"])])),_:1}),(0,l.Wm)(p,{class:"record-pagination",background:"",layout:"total, prev, pager, next, jumper",total:a.total_players,"page-size":10,"pager-count":"5",onCurrentChange:a.pull_players},null,8,["total","onCurrentChange"])])),_:1})])),_:1})}var Ne=s(7387),Ke=s.n(Ne),Je={name:"RankListIndexView",setup(){const e=(0,x.oR)();let t=(0,D.iH)([]),s=(0,D.iH)(0);const a=a=>{Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/getranklist/",type:"get",data:{page:a},headers:{Authorization:"Bearer "+e.state.user.access},success(e){t.value=JSON.parse(e.players),s.value=e.players_count}})};return(0,l.bv)((()=>{a(1)})),{players:t,total_players:s,pull_players:a}}};const Ye=(0,ie.Z)(Je,[["render",Ze],["__scopeId","data-v-0bc3a85c"]]);var Xe=Ye;const Qe=e=>((0,l.dD)("data-v-40ae4c67"),e=e(),(0,l.Cn)(),e),et={class:"card-header",style:{height:"32px"}},tt=Qe((()=>(0,l._)("span",{style:{"line-height":"32px"}},"最新对局",-1))),st=(0,l.Uk)("创建游戏"),at=(0,l.Uk)("代码"),lt=(0,l.Uk)("亲自出马"),ot=Qe((()=>(0,l._)("div",{class:"popover-code-title",style:{"user-select":"none"}},"查看代码",-1))),rt={class:"popover-content",style:{width:"250px"}},nt={class:"dialog-footer"},it=(0,l.Uk)("进入游戏"),ct=(0,l.Uk)("取消"),ut={class:"player-container"},dt={class:"player-card"},mt={class:"player-card-username"},pt={class:"records-username"},ht={key:0,class:"player-result",style:{color:"#0099CC"}},gt={key:1,class:"player-result",style:{color:"#FF0000"}},ft={key:2,class:"player-result",style:{color:"#0099CC"}},_t={class:"player-card"},wt={class:"player-card-username"},yt={class:"records-username"},vt={key:0,class:"player-result",style:{color:"#ff0000"}},bt={key:1,class:"player-result",style:{color:"#0099CC"}},kt={key:2,class:"player-result",style:{color:"#0099CC"}},Wt=(0,l.Uk)("查看录像"),xt=Qe((()=>(0,l._)("div",{class:"card-header"},[(0,l._)("span",null,"公共聊天区")],-1))),Ct={class:"username"},St={class:"main"},zt=(0,l.Uk)("发送");function Vt(e,t,s,r,n,i){const c=(0,l.up)("el-button"),u=(0,l.up)("el-radio-button"),d=(0,l.up)("el-radio-group"),m=(0,l.up)("el-form-item"),p=(0,l.up)("el-option"),h=(0,l.up)("el-select"),g=(0,l.up)("ZoomIn"),f=(0,l.up)("el-icon"),_=(0,l.up)("el-scrollbar"),w=(0,l.up)("el-popover"),y=(0,l.up)("el-form"),v=(0,l.up)("el-dialog"),b=(0,l.up)("el-card"),k=(0,l.up)("el-table-column"),W=(0,l.up)("el-avatar"),x=(0,l.up)("el-link"),C=(0,l.up)("el-table"),S=(0,l.up)("el-pagination"),z=(0,l.up)("el-col"),V=(0,l.up)("el-input"),I=(0,l.up)("el-row");return(0,l.wg)(),(0,l.j4)(I,{style:{"margin-top":"40px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{span:14,offset:2},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{class:"box-card",style:{"user-select":"none"}},{default:(0,l.w5)((()=>[(0,l._)("div",et,[tt,(0,l.Wm)(c,{class:"button",type:"primary",style:{float:"right"},onClick:t[0]||(t[0]=e=>r.showCreateGameDialog=!0)},{default:(0,l.w5)((()=>[st])),_:1}),(0,l.Wm)(v,{modelValue:r.showCreateGameDialog,"onUpdate:modelValue":t[6]||(t[6]=e=>r.showCreateGameDialog=e),title:"新建游戏"},{footer:(0,l.w5)((()=>[(0,l._)("span",nt,[(0,l.Wm)(c,{type:"primary",onClick:t[4]||(t[4]=e=>r.confirmGameDialog(r.createGameInfo.gameSelect))},{default:(0,l.w5)((()=>[it])),_:1}),(0,l.Wm)(c,{onClick:t[5]||(t[5]=e=>r.showCreateGameDialog=!1)},{default:(0,l.w5)((()=>[ct])),_:1})])])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{"label-position":"top","label-width":"100px",model:r.createGameInfo,rules:r.rules,style:{"max-width":"100%"},ref:"createGameForm"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"操作方式"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{modelValue:r.createGameInfo.operateSelect,"onUpdate:modelValue":t[1]||(t[1]=e=>r.createGameInfo.operateSelect=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{label:"0"},{default:(0,l.w5)((()=>[at])),_:1}),(0,l.Wm)(u,{label:"1"},{default:(0,l.w5)((()=>[lt])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(m,{label:"游戏"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{modelValue:r.createGameInfo.gameSelect,"onUpdate:modelValue":t[2]||(t[2]=e=>r.createGameInfo.gameSelect=e)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.games,(e=>((0,l.wg)(),(0,l.j4)(u,{key:e.id,label:e.id},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),0===parseInt(r.createGameInfo.operateSelect)?((0,l.wg)(),(0,l.j4)(m,{key:0,label:"选择Bot",prop:"botSelect"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{modelValue:r.createGameInfo.botSelect,"onUpdate:modelValue":t[3]||(t[3]=e=>r.createGameInfo.botSelect=e),class:"m-2",placeholder:"Select"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.bots,(e=>((0,l.wg)(),(0,l.j4)(p,{key:e.id,label:e.title,value:e.id,onClick:t=>r.selectBotCode(e)},null,8,["label","value","onClick"])))),128))])),_:1},8,["modelValue"]),r.createGameInfo.botSelect?((0,l.wg)(),(0,l.j4)(w,{key:0,placement:"right",width:270,trigger:"click"},{reference:(0,l.w5)((()=>[(0,l.Wm)(f,{size:15,class:"zoom"},{default:(0,l.w5)((()=>[(0,l.Wm)(g)])),_:1})])),default:(0,l.w5)((()=>[ot,(0,l.Wm)(_,{height:"300px"},{default:(0,l.w5)((()=>[(0,l._)("pre",rt,(0,o.zw)(r.botContent),1)])),_:1})])),_:1})):(0,l.kq)("",!0)])),_:1})):(0,l.kq)("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])])),_:1}),(0,l.Wm)(b,{style:{"margin-top":"25px","user-select":"none"}},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{data:r.records,style:{width:"100%"},"highlight-current-row":"","max-height":"720","table-layout":"auto"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{prop:"createtime",align:"center",label:"对局时间"}),(0,l.Wm)(k,{prop:"game",label:"游戏",align:"center",width:"190"}),(0,l.Wm)(k,{label:"玩家",align:"center",width:"220"},{default:(0,l.w5)((e=>[(0,l._)("div",ut,[(0,l._)("div",dt,[(0,l.Wm)(W,{shape:"square",size:"small",src:e.row.a_photo},null,8,["src"]),(0,l._)("span",mt,[(0,l.Wm)(x,{type:"primary",style:{"user-select":"text"}},{default:(0,l.w5)((()=>[(0,l._)("span",pt,(0,o.zw)(e.row.a_username),1)])),_:2},1024)]),"A"===e.row.result?((0,l.wg)(),(0,l.iD)("span",ht," +5 ")):"B"===e.row.result?((0,l.wg)(),(0,l.iD)("span",gt," -2 ")):"all"===e.row.result?((0,l.wg)(),(0,l.iD)("span",ft," +0 ")):(0,l.kq)("",!0)]),(0,l._)("div",_t,[(0,l.Wm)(W,{shape:"square",size:"small",src:e.row.b_photo},null,8,["src"]),(0,l._)("span",wt,[(0,l.Wm)(x,{type:"primary",style:{"user-select":"text"}},{default:(0,l.w5)((()=>[(0,l._)("span",yt,(0,o.zw)(e.row.b_username),1)])),_:2},1024)]),"A"===e.row.result?((0,l.wg)(),(0,l.iD)("span",vt," -2 ")):"B"===e.row.result?((0,l.wg)(),(0,l.iD)("span",bt," +5 ")):"all"===e.row.result?((0,l.wg)(),(0,l.iD)("span",kt," +0 ")):(0,l.kq)("",!0)])])])),_:1}),(0,l.Wm)(k,{fixed:"right",label:"Operations",align:"center"},{default:(0,l.w5)((e=>[(0,l.Wm)(c,{onClick:t=>r.see_record(e.row.id),color:"#6666CC"},{default:(0,l.w5)((()=>[Wt])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,l.Wm)(S,{class:"record-pagination",background:"",layout:"total, prev, pager, next, jumper",total:r.total_records,"page-size":10,"pager-count":"5",onCurrentChange:r.pull_records},null,8,["total","onCurrentChange"])])),_:1}),(0,l.Wm)(z,{span:5,offset:1},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{class:"message",style:{"user-select":"none"}},{header:(0,l.w5)((()=>[xt])),default:(0,l.w5)((()=>[(0,l.Wm)(b,{class:"messages",shadow:"never"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{"max-height":"320px",ref:"msgScroll"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.$store.state.record.hall_msgs,(t=>((0,l.wg)(),(0,l.iD)("div",{class:"message-content",key:t.id},[(0,l._)("div",Ct,(0,o.zw)(t.username),1),(0,l._)("div",St,[(0,l.Wm)(W,{class:"photo",size:"small",src:t.photo},null,8,["src"]),(0,l.Wm)(c,{round:"",type:e.$store.state.user.username===t.username?"primary":""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(t.text),1)])),_:2},1032,["type"])])])))),128))])),_:1},512)])),_:1}),(0,l.Wm)(b,{class:"message-send",shadow:"never"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{onSubmit:t[8]||(t[8]=(0,a.iM)((()=>{}),["prevent"]))},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{class:"message-input",autosize:{minRows:6,maxRows:6},type:"textarea",placeholder:"Please input message...",modelValue:r.message,"onUpdate:modelValue":t[7]||(t[7]=e=>r.message=e),resize:"none",onKeydown:(0,a.D2)(r.enterSendMsg,["enter"])},null,8,["modelValue","onKeydown"]),(0,l.Wm)(c,{class:"sendBtn",type:"primary",onClick:r.sendMsg,size:"small"},{default:(0,l.w5)((()=>[zt])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var It=s(6666),Ut={name:"RecordIndexView",setup(){const e=(0,x.oR)();let t=(0,D.iH)([]),s=(0,D.iH)([]),a=(0,D.iH)(null),o=(0,D.iH)(!1),r=(0,D.qj)({operateSelect:0,gameSelect:1,botSelect:null}),n=(0,D.iH)("");const i="wss://aigame.zzqahm.top/wss/hall/?token="+e.state.user.access;let c=(0,D.iH)(""),u=(0,D.iH)(!1),d=(0,D.iH)(null),m=(0,D.iH)([]),p=(0,D.iH)([]),h=(0,D.iH)(0),g=null;const f=()=>{Ke().ajax({url:"https://aigame.zzqahm.top/backend/game/getlist/",type:"get",headers:{Authorization:"Bearer "+e.state.user.access},success(e){t.value=e}})},_=()=>{Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/bot/getlist_game/",type:"get",data:{game_id:r.gameSelect},headers:{Authorization:"Bearer "+e.state.user.access},success(e){s.value=e}})};_(),(0,l.YP)((()=>r.gameSelect),(()=>{_(),r.botSelect=null,n.value=""}));const w=e=>{n.value=e.content};(0,l.bv)((()=>{(0,It.bM)({title:"Welcome",message:(0,l.h)("i",{style:"color: teal"},"欢迎来到King Of Bots游戏对战平台！"),offset:70}),f(),k(1),g=new WebSocket(i),g.onopen=()=>{console.log("connected!"),u.value=!0,e.commit("updateHallSocket",g)},g.onmessage=t=>{const s=JSON.parse(t.data);s.username!==e.state.user.username&&"hall_message"===s.event&&e.commit("pushHallMsg",s.msg)},g.onclose=()=>{u.value=!1,console.log("disconnected!")}}));const y=async e=>{const t=(0,D.SU)(a);await t.validate((t=>{t&&(o.value=!1,1==r.operateSelect&&(r.botSelect=-1),qa.push({name:"pk_index",params:{game:e},query:{operate:r.operateSelect,bot_id:r.botSelect}}))}))};(0,l.Ah)((()=>{g.close()}));const v=()=>{u.value&&""!==c.value&&(e.state.record.hall_socket.send(JSON.stringify({event:"hall_message",username:e.state.user.username,photo:e.state.user.photo,text:c.value})),u.value=!1,setTimeout((()=>{u.value=!0}),1500),c.value="")},b=e=>{e.ctrlKey&&13===e.keyCode?c.value+="\n":(e.preventDefault(),v())},k=t=>{Ke().ajax({url:"https://aigame.zzqahm.top/backend/record/getlist/",type:"get",data:{page:t},headers:{Authorization:"Bearer "+e.state.user.access},success(e){m.value=JSON.parse(e.records),h.value=e.records_count}})},W=e=>{let t=[];for(let s=0,a=0;s<13;s++){let s=[];for(let t=0;t<14;t++,a++)"0"===e[a]?s.push(0):s.push(1);t.push(s)}return t},C=t=>{for(const s of m.value)if(s.id===t){p.value=s.game_id,e.commit("updateIsRecord",!0),e.commit("updateGame",{map:W(s.map),a_id:s.a_id,a_sx:s.a_sx,a_sy:s.a_sy,b_id:s.b_id,b_sx:s.b_sx,b_sy:s.b_sy}),e.commit("updateSteps",{a_steps:s.a_steps,b_steps:s.b_steps}),e.commit("updateRecordLoser",s.result),qa.push({name:"record_content",params:{recordId:t,game:p.value}});break}};return{games:t,showCreateGameDialog:o,confirmGameDialog:y,createGameInfo:r,bots:s,selectBotCode:w,botContent:n,createGameForm:a,rules:{botSelect:[{required:!0,message:"请选择Bot！",trigger:"blur"}]},message:c,sendMsg:v,enterSendMsg:b,msgScroll:d,records:m,see_record:C,total_records:h,pull_records:k}}};const jt=(0,ie.Z)(Ut,[["render",Vt],["__scopeId","data-v-40ae4c67"]]);var Lt=jt;function Mt(e,t,s,a,o,r){const n=(0,l.up)("PlayGround"),i=(0,l.up)("el-col"),c=(0,l.up)("el-row");return(0,l.wg)(),(0,l.j4)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,{span:14,offset:2},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{game:a.game},null,8,["game"])])),_:1}),(0,l.Wm)(i,{span:5,offset:1,style:{"margin-top":"40px"}})])),_:1})}var Bt={components:{PlayGround:Ve},setup(){const e=(0,C.yj)(),t=parseInt(e.params.game);return{game:t}}};const qt=(0,ie.Z)(Bt,[["render",Mt]]);var Dt=qt;const Ft=(0,l.Uk)(" 讨论区 ");function Ot(e,t,s,a,o,r){const n=(0,l.up)("ContentField");return(0,l.wg)(),(0,l.j4)(n,null,{default:(0,l.w5)((()=>[Ft])),_:1})}const Pt={class:"content-field"};function Ht(e,t,s,a,o,r){const n=(0,l.up)("el-card"),i=(0,l.up)("el-col"),c=(0,l.up)("el-row");return(0,l.wg)(),(0,l.iD)("div",Pt,[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,{span:18,offset:3},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{shadow:"always",class:"card"},{default:(0,l.w5)((()=>[(0,l.WI)(e.$slots,"default",{},void 0,!0)])),_:3})])),_:3})])),_:3})])}var Et={name:"ContentField"};const At=(0,ie.Z)(Et,[["render",Ht],["__scopeId","data-v-08e11878"]]);var $t=At,Gt={name:"DiscussionView",components:{ContentField:$t}};const Rt=(0,ie.Z)(Gt,[["render",Ot]]);var Tt=Rt;const Zt=(0,l.Uk)(" 留言板 ");function Nt(e,t,s,a,o,r){const n=(0,l.up)("ContentField");return(0,l.wg)(),(0,l.j4)(n,null,{default:(0,l.w5)((()=>[Zt])),_:1})}var Kt={name:"MessageBoardView",components:{ContentField:$t}};const Jt=(0,ie.Z)(Kt,[["render",Nt]]);var Yt=Jt;const Xt=e=>((0,l.dD)("data-v-40e96588"),e=e(),(0,l.Cn)(),e),Qt=Xt((()=>(0,l._)("div",{class:"background"},null,-1))),es={class:"content"},ts={class:"photo"},ss=["src"],as={class:"username"},ls=Xt((()=>(0,l._)("div",{class:"profession"}," Web Developer at Webestica ",-1))),os=Xt((()=>(0,l._)("div",{class:"description"}," I'd love to change the world, but they won’t give me the source code. ",-1))),rs=Xt((()=>(0,l._)("div",{class:"friend-num-container"},[(0,l._)("div",null,[(0,l._)("h6",{class:"num"},"256"),(0,l._)("small",{class:"text"},"Post")]),(0,l._)("div",{class:"vertical-divider"}),(0,l._)("div",null,[(0,l._)("h6",{class:"num"},"2.5K"),(0,l._)("small",{class:"text"},"Followers")]),(0,l._)("div",{class:"vertical-divider"}),(0,l._)("div",null,[(0,l._)("h6",{class:"num"},"365"),(0,l._)("small",{class:"text"},"Following")])],-1))),ns=Xt((()=>(0,l._)("div",{class:"horizontal-divider"},null,-1))),is={class:"card-header"},cs=Xt((()=>(0,l._)("span",{style:{"font-weight":"700","font-size":"18px"}},"我的Bot",-1))),us=(0,l.Uk)("创造Bot"),ds=(0,l.Uk)("cpp"),ms=(0,l.Uk)("java"),ps=(0,l.Uk)("python"),hs=Xt((()=>(0,l._)("div",{style:{"flex-grow":"1"}},null,-1))),gs={class:"gear"},fs=(0,l.Uk)("chrome"),_s=(0,l.Uk)("monokai"),ws=(0,l.Uk)("Standard"),ys=(0,l.Uk)("Vim"),vs=(0,l.Uk)("Emacs"),bs=(0,l.Uk)("2"),ks=(0,l.Uk)("4"),Ws=(0,l.Uk)("8"),xs={class:"dialog-footer"},Cs=(0,l.Uk)("创建"),Ss=(0,l.Uk)("取消"),zs=(0,l.Uk)("修改"),Vs=(0,l.Uk)("删除"),Is=(0,l.Uk)("cpp"),Us=(0,l.Uk)("java"),js=(0,l.Uk)("python"),Ls=Xt((()=>(0,l._)("div",{style:{"flex-grow":"1"}},null,-1))),Ms={class:"gear"},Bs=(0,l.Uk)("chrome"),qs=(0,l.Uk)("monokai"),Ds=(0,l.Uk)("Standard"),Fs=(0,l.Uk)("Vim"),Os=(0,l.Uk)("Emacs"),Ps=(0,l.Uk)("2"),Hs=(0,l.Uk)("4"),Es=(0,l.Uk)("8"),As={class:"dialog-footer"},$s=(0,l.Uk)("保存修改"),Gs=(0,l.Uk)("取消"),Rs={class:"dialog-footer"},Ts=(0,l.Uk)("确认删除"),Zs=(0,l.Uk)("取消");function Ns(e,t,s,a,r,n){const i=(0,l.up)("el-col"),c=(0,l.up)("el-row"),u=(0,l.up)("el-card"),d=(0,l.up)("el-button"),m=(0,l.up)("el-input"),p=(0,l.up)("el-form-item"),h=(0,l.up)("el-radio-button"),g=(0,l.up)("el-radio-group"),f=(0,l.up)("Refresh"),_=(0,l.up)("el-icon"),w=(0,l.up)("Tools"),y=(0,l.up)("el-input-number"),v=(0,l.up)("el-dropdown-menu"),b=(0,l.up)("el-dropdown"),k=(0,l.up)("VAceEditor"),W=(0,l.up)("el-form"),x=(0,l.up)("el-dialog"),C=(0,l.up)("el-table-column"),S=(0,l.up)("el-table");return(0,l.wg)(),(0,l.j4)(c,{style:{"margin-top":"40px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{span:5,offset:2},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"profile-card",shadow:"always"},{default:(0,l.w5)((()=>[Qt,(0,l._)("div",es,[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,{span:6,offset:9},{default:(0,l.w5)((()=>[(0,l._)("div",ts,[(0,l._)("img",{src:e.$store.state.user.photo,alt:"",class:"",style:{"user-select":"none"}},null,8,ss)])])),_:1})])),_:1}),(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,{span:20,offset:2},{default:(0,l.w5)((()=>[(0,l._)("div",as,(0,o.zw)(e.$store.state.user.username),1),ls,os,rs,ns])),_:1})])),_:1})])])),_:1})])),_:1}),(0,l.Wm)(i,{span:14,offset:1},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{shadow:"always",class:"bot-card",style:{"user-select":"none"}},{header:(0,l.w5)((()=>[(0,l._)("div",is,[cs,(0,l.Wm)(d,{type:"primary",class:"button",style:{float:"right"},size:"small",plain:"",onClick:t[0]||(t[0]=e=>a.showCreateDialog=!0)},{default:(0,l.w5)((()=>[us])),_:1}),(0,l.Wm)(m,{style:{"margin-right":"10px",float:"right",width:"180px"},modelValue:a.search,"onUpdate:modelValue":t[1]||(t[1]=e=>a.search=e),clearable:"",placeholder:"Please search...",size:"small"},null,8,["modelValue"]),(0,l.Wm)(x,{modelValue:a.showCreateDialog,"onUpdate:modelValue":t[12]||(t[12]=e=>a.showCreateDialog=e),title:"创建Bot",onOpened:t[13]||(t[13]=e=>a.openCodeDialog("-create"))},{footer:(0,l.w5)((()=>[(0,l._)("span",xs,[(0,l.Wm)(d,{type:"primary",onClick:a.confirmCreateBot},{default:(0,l.w5)((()=>[Cs])),_:1},8,["onClick"]),(0,l.Wm)(d,{onClick:a.cancelCreateBot},{default:(0,l.w5)((()=>[Ss])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l.Wm)(W,{"label-position":"top","label-width":"100px",model:a.bot,style:{"max-width":"100%"},rules:a.rules,ref:"createForm"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{label:"名称",prop:"title"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:a.bot.title,"onUpdate:modelValue":t[2]||(t[2]=e=>a.bot.title=e),placeholder:"请输入Bot名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{label:"游戏",prop:"game"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:a.bot.game,"onUpdate:modelValue":t[3]||(t[3]=e=>a.bot.game=e)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.games,(e=>((0,l.wg)(),(0,l.j4)(h,{key:e.id,label:e.id},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(p,{label:"简介",prop:"description"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:a.bot.description,"onUpdate:modelValue":t[4]||(t[4]=e=>a.bot.description=e),autosize:{minRows:3},type:"textarea",placeholder:"请输入Bot简介"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{label:"语言",prop:"language"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:a.bot.language,"onUpdate:modelValue":t[5]||(t[5]=e=>a.bot.language=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"cpp"},{default:(0,l.w5)((()=>[ds])),_:1}),(0,l.Wm)(h,{label:"java"},{default:(0,l.w5)((()=>[ms])),_:1}),(0,l.Wm)(h,{label:"python"},{default:(0,l.w5)((()=>[ps])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(p,{label:"代码"},{default:(0,l.w5)((()=>[hs,(0,l._)("span",{class:"refresh",onClick:t[6]||(t[6]=(...e)=>a.refreshEditor&&a.refreshEditor(...e))},[(0,l.Wm)(_,{size:25},{default:(0,l.w5)((()=>[(0,l.Wm)(f)])),_:1})]),(0,l.Wm)(b,null,{dropdown:(0,l.w5)((()=>[(0,l.Wm)(v,{style:{"user-select":"none"}},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{label:"界面风格",style:{margin:"15px 15px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:a.skin,"onUpdate:modelValue":t[7]||(t[7]=e=>a.skin=e),onChange:a.changeEditSkin},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"chrome"},{default:(0,l.w5)((()=>[fs])),_:1}),(0,l.Wm)(h,{label:"monokai"},{default:(0,l.w5)((()=>[_s])),_:1})])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.Wm)(p,{label:"编辑类型",style:{margin:"15px 15px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:a.editor_mode,"onUpdate:modelValue":t[8]||(t[8]=e=>a.editor_mode=e),onChange:a.changeEditMode},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"vscode"},{default:(0,l.w5)((()=>[ws])),_:1}),(0,l.Wm)(h,{label:"vim"},{default:(0,l.w5)((()=>[ys])),_:1}),(0,l.Wm)(h,{label:"emacs"},{default:(0,l.w5)((()=>[vs])),_:1})])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.Wm)(p,{label:"缩进长度",style:{margin:"15px 15px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:a.editor_space,"onUpdate:modelValue":t[9]||(t[9]=e=>a.editor_space=e),onChange:a.changeEditorSpace},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"2"},{default:(0,l.w5)((()=>[bs])),_:1}),(0,l.Wm)(h,{label:"4"},{default:(0,l.w5)((()=>[ks])),_:1}),(0,l.Wm)(h,{label:"8"},{default:(0,l.w5)((()=>[Ws])),_:1})])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.Wm)(p,{label:"字号",style:{margin:"15px 15px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{modelValue:a.fontsize,"onUpdate:modelValue":t[10]||(t[10]=e=>a.fontsize=e),min:5,max:60,size:"small","controls-position":"right",onChange:a.changeEditFont},null,8,["modelValue","onChange"])])),_:1})])),_:1})])),default:(0,l.w5)((()=>[(0,l._)("span",gs,[(0,l.Wm)(_,{size:25},{default:(0,l.w5)((()=>[(0,l.Wm)(w)])),_:1})])])),_:1}),(0,l.Wm)(k,{value:a.bot.content,"onUpdate:value":t[11]||(t[11]=e=>a.bot.content=e),id:"codeEditor-create",onInit:a.editorInit,class:"codeEditor",lang:"c_cpp",theme:"textmate",style:{height:"300px",width:"100%"}},null,8,["value","onInit"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])])),default:(0,l.w5)((()=>[(0,l.Wm)(S,{data:a.filterBots,stripe:"",style:{width:"100%"},"highlight-current-row":"",border:"","max-height":"67vh","table-layout":"auto"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{label:"序号",type:"index"}),(0,l.Wm)(C,{prop:"title",label:"名称"}),(0,l.Wm)(C,{prop:"game",label:"游戏"}),(0,l.Wm)(C,{prop:"language",label:"语言"}),(0,l.Wm)(C,{prop:"createtime",label:"创建时间",sortable:""}),(0,l.Wm)(C,{fixed:"right",label:"Operations"},{default:(0,l.w5)((e=>[(0,l.Wm)(d,{onClick:t=>a.openEditBot(e.row),color:"#626aef"},{default:(0,l.w5)((()=>[zs])),_:2},1032,["onClick"]),(0,l.Wm)(d,{type:"danger",onClick:t=>a.openDeleteBot(e.row)},{default:(0,l.w5)((()=>[Vs])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,l.Wm)(x,{modelValue:a.showEditDialog,"onUpdate:modelValue":t[23]||(t[23]=e=>a.showEditDialog=e),title:"修改Bot",onOpened:t[24]||(t[24]=e=>a.openCodeDialog("-edit"))},{footer:(0,l.w5)((()=>[(0,l._)("span",As,[(0,l.Wm)(d,{type:"primary",onClick:a.confirmEditBot},{default:(0,l.w5)((()=>[$s])),_:1},8,["onClick"]),(0,l.Wm)(d,{onClick:a.cancelEditBot},{default:(0,l.w5)((()=>[Gs])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l.Wm)(W,{"label-position":"top","label-width":"100px",model:a.currentOpBot,style:{"max-width":"100%"},rules:a.rules,ref:"editForm"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{label:"名称",prop:"title"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:a.currentOpBot.title,"onUpdate:modelValue":t[14]||(t[14]=e=>a.currentOpBot.title=e),placeholder:"请输入Bot名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{label:"简介",prop:"description"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:a.currentOpBot.description,"onUpdate:modelValue":t[15]||(t[15]=e=>a.currentOpBot.description=e),autosize:{minRows:3},type:"textarea",placeholder:"请输入Bot简介"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{label:"语言",prop:"language"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:a.currentOpBot.language,"onUpdate:modelValue":t[16]||(t[16]=e=>a.currentOpBot.language=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"cpp"},{default:(0,l.w5)((()=>[Is])),_:1}),(0,l.Wm)(h,{label:"java"},{default:(0,l.w5)((()=>[Us])),_:1}),(0,l.Wm)(h,{label:"python"},{default:(0,l.w5)((()=>[js])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(p,{label:"代码"},{default:(0,l.w5)((()=>[Ls,(0,l._)("span",{class:"refresh",onClick:t[17]||(t[17]=(...e)=>a.refreshEditor&&a.refreshEditor(...e))},[(0,l.Wm)(_,{size:25},{default:(0,l.w5)((()=>[(0,l.Wm)(f)])),_:1})]),(0,l.Wm)(b,null,{dropdown:(0,l.w5)((()=>[(0,l.Wm)(v,{style:{"user-select":"none"}},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{label:"界面风格",style:{margin:"15px 15px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:a.skin,"onUpdate:modelValue":t[18]||(t[18]=e=>a.skin=e),onChange:a.changeEditSkin},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"chrome"},{default:(0,l.w5)((()=>[Bs])),_:1}),(0,l.Wm)(h,{label:"monokai"},{default:(0,l.w5)((()=>[qs])),_:1})])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.Wm)(p,{label:"编辑类型",style:{margin:"15px 15px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:a.editor_mode,"onUpdate:modelValue":t[19]||(t[19]=e=>a.editor_mode=e),onChange:a.changeEditMode},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"vscode"},{default:(0,l.w5)((()=>[Ds])),_:1}),(0,l.Wm)(h,{label:"vim"},{default:(0,l.w5)((()=>[Fs])),_:1}),(0,l.Wm)(h,{label:"emacs"},{default:(0,l.w5)((()=>[Os])),_:1})])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.Wm)(p,{label:"缩进长度",style:{margin:"15px 15px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{modelValue:a.editor_space,"onUpdate:modelValue":t[20]||(t[20]=e=>a.editor_space=e),onChange:a.changeEditorSpace},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"2"},{default:(0,l.w5)((()=>[Ps])),_:1}),(0,l.Wm)(h,{label:"4"},{default:(0,l.w5)((()=>[Hs])),_:1}),(0,l.Wm)(h,{label:"8"},{default:(0,l.w5)((()=>[Es])),_:1})])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.Wm)(p,{label:"字号",style:{margin:"15px 15px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{modelValue:a.fontsize,"onUpdate:modelValue":t[21]||(t[21]=e=>a.fontsize=e),min:5,max:60,size:"small","controls-position":"right",onChange:a.changeEditFont},null,8,["modelValue","onChange"])])),_:1})])),_:1})])),default:(0,l.w5)((()=>[(0,l._)("span",Ms,[(0,l.Wm)(_,{size:25},{default:(0,l.w5)((()=>[(0,l.Wm)(w)])),_:1})])])),_:1}),(0,l.Wm)(k,{value:a.currentOpBot.content,"onUpdate:value":t[22]||(t[22]=e=>a.currentOpBot.content=e),id:"codeEditor-edit",onInit:a.editorInit,class:"codeEditor",lang:"c_cpp",theme:"textmate",style:{height:"300px",width:"100%"}},null,8,["value","onInit"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),(0,l.Wm)(x,{modelValue:a.showDeleteDialog,"onUpdate:modelValue":t[25]||(t[25]=e=>a.showDeleteDialog=e),title:"删除bot",width:"30%","before-close":e.handleClose},{footer:(0,l.w5)((()=>[(0,l._)("span",Rs,[(0,l.Wm)(d,{type:"primary",onClick:a.confirmDeleteBot},{default:(0,l.w5)((()=>[Ts])),_:1},8,["onClick"]),(0,l.Wm)(d,{onClick:a.cancelDeleteBot},{default:(0,l.w5)((()=>[Zs])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l._)("span",null,"确认删除标题为 "+(0,o.zw)(a.currentOpBot.title)+" 吗?",1)])),_:1},8,["modelValue","before-close"])])),_:1})])),_:1})])),_:1})}s(6699),s(1703);var Ks=s(7178),Js=s(6092),Ys=s(17),Xs={name:"UserBotIndexView",components:{VAceEditor:Js.m},setup(){Ys.config.set("basePath","https://cdn.jsdelivr.net/npm/ace-builds@"+s(17).version+"/src-noconflict/");const e=(0,x.oR)();let t=(0,D.iH)([]),a=(0,D.iH)([]),o=(0,D.iH)(""),r=(0,D.iH)(!1),n=(0,D.iH)(!1),i=(0,D.iH)(!1),c=(0,D.iH)(null),u=(0,D.iH)(null),d=(0,D.iH)(null),m=null,p=(0,D.iH)("chrome"),h=(0,D.iH)(11),g=(0,D.iH)("vscode"),f=(0,D.iH)(4);const _=e=>{e.renderer.setShowPrintMargin(!1)},w=()=>{null!==localStorage.getItem("editor_skin_for_"+e.state.user.username)&&(p.value=localStorage.getItem("editor_skin_for_"+e.state.user.username)),null!==localStorage.getItem("editor_fontsize_for_"+e.state.user.username)&&(h.value=parseInt(localStorage.getItem("editor_fontsize_for_"+e.state.user.username))),null!==localStorage.getItem("editor_mode_for_"+e.state.user.username)&&(g.value=localStorage.getItem("editor_mode_for_"+e.state.user.username)),null!==localStorage.getItem("editor_space_for_"+e.state.user.username)&&(f.value=localStorage.getItem("editor_space_for_"+e.state.user.username)),m.setOptions({fontSize:`${h.value}pt`,tabSize:parseInt(f.value)}),m.setKeyboardHandler("ace/keyboard/"+g.value),m.setTheme("ace/theme/"+p.value)},y=()=>{m.setTheme("ace/theme/"+p.value),localStorage.setItem("editor_skin_for_"+e.state.user.username,p.value)},v=t=>{m.setOptions({fontSize:`${t}pt`}),h.value=t,localStorage.setItem("editor_fontsize_for_"+e.state.user.username,t)},b=()=>{m.setKeyboardHandler("ace/keyboard/"+g.value),localStorage.setItem("editor_mode_for_"+e.state.user.username,g.value)},k=()=>{m.setOptions({tabSize:parseInt(f.value)}),localStorage.setItem("editor_space_for_"+e.state.user.username,f.value)},W=()=>{m.setValue("")},C=(0,D.qj)({title:"",game:0,description:"",language:"",content:""}),S=()=>{Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/bot/getlist/",type:"get",headers:{Authorization:"Bearer "+e.state.user.access},success(e){t.value=e}})},z=()=>{Ke().ajax({url:"https://aigame.zzqahm.top/backend/game/getlist/",type:"get",headers:{Authorization:"Bearer "+e.state.user.access},success(e){a.value=e}})};S(),(0,l.bv)((()=>{z()}));const V=()=>{Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/bot/add/",type:"post",data:{title:C.title,game_id:C.game,description:C.description,language:C.language,content:C.content},headers:{Authorization:"Bearer "+e.state.user.access},success(e){"success"===e.result?(C.title="",C.game=0,C.description="",C.content="",S(),(0,Ks.z8)({message:"创建成功",type:"success"})):Ks.z8.error(e.result)},error(e){console.log(e)}})},I=t=>{Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/bot/remove/",type:"post",data:{bot_id:t.id},headers:{Authorization:"Bearer "+e.state.user.access},success(e){"success"===e.result&&(S(),(0,Ks.z8)({showClose:!0,message:"删除成功",type:"success"}))}})},U=t=>{console.log(t),Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/bot/update/",type:"post",data:{bot_id:t.id,title:t.title,description:t.description,language:t.language,content:t.content},headers:{Authorization:"Bearer "+e.state.user.access},success(e){"success"===e.result?(S(),(0,Ks.z8)({showClose:!0,message:"更新成功",type:"success"})):Ks.z8.error(e.result)}})},j=(0,l.Fl)((()=>t.value.filter((e=>!o.value||e.game.toLowerCase().includes(o.value.toLowerCase())||e.title.toLowerCase().includes(o.value.toLowerCase())||e.createtime.includes(o.value))))),L=e=>{m=Ys.edit("codeEditor"+e),w()},M=e=>{d.value=e,n.value=!0},B=e=>{i.value=!0,d.value=e},q=async()=>{const e=(0,D.SU)(c);await e.validate((e=>{""!==C.content?C.content.length>1e4?(0,Ks.z8)({showClose:!0,message:"代码不能超过10000",type:"error"}):e&&(r.value=!1,V()):(0,Ks.z8)({showClose:!0,message:"代码不能为空",type:"error"})}))},F=(e,t,s)=>{0===C.game?s(new Error("请选择游戏！")):s()},O=()=>{r.value=!1,(0,Ks.z8)("取消创建");const e=(0,D.SU)(c);e.resetFields()},P=async()=>{const e=(0,D.SU)(u);await e.validate((e=>{""!==d.value.content?d.value.content.length>1e4?(0,Ks.z8)({showClose:!0,message:"代码不能超过10000",type:"error"}):e&&(n.value=!1,U(d.value)):(0,Ks.z8)({showClose:!0,message:"代码不能为空",type:"error"})}))},H=()=>{n.value=!1,(0,Ks.z8)("取消修改");const e=(0,D.SU)(u);e.resetFields()},E=()=>{i.value=!1,I(d.value)},A=()=>{i.value=!1,(0,Ks.z8)("取消删除")};return{bots:t,games:a,bot:C,search:o,filterBots:j,showCreateDialog:r,showEditDialog:n,showDeleteDialog:i,openCodeDialog:L,openEditBot:M,openDeleteBot:B,confirmCreateBot:q,cancelCreateBot:O,confirmEditBot:P,cancelEditBot:H,confirmDeleteBot:E,cancelDeleteBot:A,createForm:c,editForm:u,currentOpBot:d,editorInit:_,initModal:w,changeEditSkin:y,changeEditFont:v,changeEditMode:b,changeEditorSpace:k,skin:p,fontsize:h,editor_mode:g,editor_space:f,refreshEditor:W,rules:{title:[{required:!0,message:"名称不得为空！",trigger:"blur"},{max:100,message:"长度在 100 个字符之内",trigger:"blur"}],game:[{validator:F,required:!0,message:"请选择游戏！",trigger:"blur"}],description:[{max:300,message:"长度在 300 个字符之内",trigger:"blur"}],language:[{required:!0,message:"请选择语言！",trigger:"blur"}]}}}};const Qs=(0,ie.Z)(Xs,[["render",Ns],["__scopeId","data-v-40e96588"]]);var ea=Qs;const ta=(0,l.Uk)(" 404 Not Found ");function sa(e,t,s,a,o,r){const n=(0,l.up)("ContentField");return(0,l.wg)(),(0,l.j4)(n,null,{default:(0,l.w5)((()=>[ta])),_:1})}var aa={name:"NotFound",components:{ContentField:$t}};const la=(0,ie.Z)(aa,[["render",sa]]);var oa=la;const ra=(0,l.Uk)("登录");function na(e,t,s,a,o,r){const n=(0,l.up)("el-input"),i=(0,l.up)("el-form-item"),c=(0,l.up)("SliderVerify"),u=(0,l.up)("el-button"),d=(0,l.up)("el-form"),m=(0,l.up)("el-col"),p=(0,l.up)("el-row"),h=(0,l.up)("ContentField");return e.$store.state.user.pulling_info?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(h,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{span:8,offset:8},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{model:a.log_info,rules:a.rules,ref:"ruleForm","label-width":"50px","label-position":"top",style:{"user-select":"none"}},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{label:"帐号",prop:"username"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:a.log_info.username,"onUpdate:modelValue":t[0]||(t[0]=e=>a.log_info.username=e),placeholder:"请输入账号",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(i,{label:"密码",prop:"password"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{type:"password",modelValue:a.log_info.password,"onUpdate:modelValue":t[1]||(t[1]=e=>a.log_info.password=e),placeholder:"请输入密码",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{modelValue:a.log_info.isLock,"onUpdate:modelValue":t[2]||(t[2]=e=>a.log_info.isLock=e),onChange:a.handlerLock,class:"verify"},null,8,["modelValue","onChange"]),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{type:"primary",onClick:a.login,style:{width:"100%"}},{default:(0,l.w5)((()=>[ra])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})])),_:1}))}const ia=e=>((0,l.dD)("data-v-2302ecf0"),e=e(),(0,l.Cn)(),e),ca=ia((()=>(0,l._)("div",{class:"background"},null,-1))),ua=(0,l.Uk)(" >> ");function da(e,t,s,a,r,n){return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",{class:"drag",style:(0,o.j5)(n.style)},[ca,(0,l._)("div",{class:"text shadow",onselectstart:"return false",style:(0,o.j5)({color:s.textColor})},[(0,l.WI)(e.$slots,"content",{},(()=>[(0,l.Uk)((0,o.zw)(s.content),1)]),!0)],4),(0,l._)("div",{class:"slider",style:(0,o.j5)({height:s.height,width:s.sliderWidth})},[s.icon?(0,l.WI)(e.$slots,"icon",{key:0},(()=>[(0,l._)("i",{class:(0,o.C_)(s.icon)},null,2)]),!0):(0,l.WI)(e.$slots,"icon",{key:1},(()=>[ua]),!0)],4)],4)])}const ma=function(){let e=0;return function(t,s){clearTimeout(e),e=setTimeout(t,s)}}();var pa={name:"SliderVerify",model:{event:"change",prop:"isLock"},props:{isLock:{type:[String,Boolean,Number,Object],required:!0,default:!1},icon:{type:[String],default:"el-icon-d-arrow-right"},activeValue:{type:[String,Boolean,Number,Object],default:!0},inactiveValue:{type:[String,Boolean,Number,Object],default:!1},content:{type:[String],default:"请向右拖动滑块"},height:{type:[String],default:"40px"},sliderWidth:{type:[String],default:"40px"},background:{type:[String],default:"#e8e8e8"},textColor:{type:[String],default:"#777"}},watch:{isLock(e){!e&&this.init()}},computed:{style(){const{height:e,background:t}=this;return{height:e,"line-height":e,background:t}},resize(){return document.body.clientWidth}},mounted(){this.init(),window.onresize=()=>{ma((()=>{this.init()}),120)}},methods:{selector(e){return document.querySelector(e)},init(){const e=this.selector(".drag");if(e){const t=this.selector(".background"),s=this.selector(".text"),a=this.selector(".slider"),l=e.offsetWidth-a.offsetWidth;let o=this.inactiveValue;a.style.transition=null,t.style.transition=null,a.style.left="0px",t.style.width="0px",s.innerHTML=this.content,a.innerHTML='<i class="el-icon-d-arrow-right"></i>',a.style.color="#3fcd26",a.onmousedown=e=>{a.style.transition=null,t.style.transition=null;const r=e||window.event,n=r.clientX;document.onmousemove=e=>{const r=e||window.event,i=r.clientX;let c=i-n;c>l?c=l:c<0&&(c=0),a.style.left=c+"px",t.style.width=c+"px",c==l&&(s.innerHTML="验证成功",s.style.color="#53C300",a.innerHTML='<i class="el-icon-success"></i>',a.style.color="#53C300",o=this.activeValue,a.onmousedown=null,document.onmousemove=null,setTimeout((()=>{this.$emit("change",this.activeValue)}),100))},document.onmouseup=()=>{if(o==this.activeValue)return!0;a.style.left=0,t.style.width=0,a.style.transition="left 1s ease",t.style.transition="width 1s ease",document.onmousemove=null,document.onmouseup=null}},a.ontouchstart=e=>{const r=e.changedTouches[0];a.style.transition=null,t.style.transition=null;const n=r.pageX;document.ontouchmove=e=>{const r=e.changedTouches[0],i=r.pageX;let c=i-n;c>l?c=l:c<0&&(c=0),a.style.left=c+"px",t.style.width=c+"px",c==l&&(s.innerHTML="验证成功",s.style.color="#53C300",a.innerHTML="&radic;",a.style.color="#53C300",o=this.activeValue,a.ontouchstart=null,document.ontouchmove=null,setTimeout((()=>{this.$emit("change",this.activeValue)}),100))},document.ontouchend=()=>{if(o==this.activeValue)return!0;a.style.left=0,t.style.width=0,a.style.transition="left 1s ease",t.style.transition="width 1s ease",document.ontouchmove=null,document.ontouchend=null}}}}}};const ha=(0,ie.Z)(pa,[["render",da],["__scopeId","data-v-2302ecf0"]]);var ga=ha,fa={name:"UserAccountLoginView",components:{ContentField:$t,SliderVerify:ga},setup(){const e=(0,x.oR)(),t=(0,D.iH)(null);let s=(0,D.qj)({username:"",password:"",isLock:!1});const a=localStorage.getItem("aigame.access"),l=localStorage.getItem("aigame.refresh");a&&l?(e.commit("updateToken",{access:a,refresh:l}),e.dispatch("refresh_access",l),e.dispatch("getinfo",{success(){qa.push({name:"home"}),e.commit("updatePullingInfo",!1)},error(){e.commit("updatePullingInfo",!1),localStorage.removeItem("aigame.access"),localStorage.removeItem("aigame.refresh")}})):e.commit("updatePullingInfo",!1);const o=async()=>{const a=(0,D.SU)(t);await a.validate((t=>{!1!==s.isLock?t&&e.dispatch("login",{...s,success(){(0,Ks.z8)({showClose:!0,message:"登录成功！",type:"success"}),e.dispatch("getinfo",{success(){qa.push({name:"home"})}})},error(){(0,Ks.z8)({showClose:!0,message:"用户名或密码错误！",type:"error"})}}):(0,Ks.z8)({showClose:!0,message:"请拖动滑块完成验证",type:"error"})}))},r=async e=>{if(e){""!==s.username&&""!==s.password&&s.username&&s.password||(0,Ks.z8)({showClose:!0,message:"请先输入用户名密码！",type:"error"}),s.isLock=!0;const e=(0,D.SU)(t);await e.validateField("isLock")}},n=(e,t,a)=>{if(!t)return a(new Error("请拖动滑块完成验证"));""!==s.username&&""!==s.password&&s.username&&s.password||setTimeout((()=>(s.isLock=!1,s.validateField("username"),s.validateField("password"),a(new Error("验证未通过")))),1),a()};return{ruleForm:t,log_info:s,login:o,handlerLock:r,rules:{username:[{required:!0,message:"用户名称不得为空！",trigger:"blur"}],password:[{required:!0,message:"密码不得为空！",trigger:"blur"}],isLock:[{validator:n,trigger:"blur"}]}}}};const _a=(0,ie.Z)(fa,[["render",na],["__scopeId","data-v-87ac9ea0"]]);var wa=_a;const ya=(0,l.Uk)("注册");function va(e,t,s,a,o,r){const n=(0,l.up)("el-input"),i=(0,l.up)("el-form-item"),c=(0,l.up)("PasswordStrength"),u=(0,l.up)("SliderVerify"),d=(0,l.up)("el-button"),m=(0,l.up)("el-form"),p=(0,l.up)("el-col"),h=(0,l.up)("el-row"),g=(0,l.up)("ContentField");return(0,l.wg)(),(0,l.j4)(g,null,{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{span:8,offset:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{model:a.register_info,rules:a.rules,ref:"ruleForm","label-width":"50px","label-position":"top",style:{"user-select":"none"}},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{label:"帐号",prop:"username"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:a.register_info.username,"onUpdate:modelValue":t[0]||(t[0]=e=>a.register_info.username=e),placeholder:"请输入账号",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(i,{label:"密码",prop:"password"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{type:"password",modelValue:a.register_info.password,"onUpdate:modelValue":t[1]||(t[1]=e=>a.register_info.password=e),placeholder:"请输入密码",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(i,{label:"确认密码",prop:"password_confirm"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{type:"password",modelValue:a.register_info.password_confirm,"onUpdate:modelValue":t[2]||(t[2]=e=>a.register_info.password_confirm=e),placeholder:"请输入确认密码",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{passwordStr:a.register_info.password,"onUpdate:passwordStr":t[3]||(t[3]=e=>a.register_info.password=e),style:{"padding-top":"10px"}},null,8,["passwordStr"]),(0,l.Wm)(u,{prop:"isLock",modelValue:a.register_info.isLock,"onUpdate:modelValue":t[4]||(t[4]=e=>a.register_info.isLock=e),onChange:a.handlerLock,class:"verify"},null,8,["modelValue","onChange"]),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(d,{type:"primary",onClick:a.register,style:{width:"100%"}},{default:(0,l.w5)((()=>[ya])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})])),_:1})}const ba={id:"container",style:{"margin-bottom":"16px"}};function ka(e,t,s,a,r,n){const i=(0,l.up)("el-progress"),c=(0,l.up)("el-col"),u=(0,l.up)("el-row");return(0,l.wg)(),(0,l.iD)("div",ba,[(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{span:6,offset:1},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{percentage:r.onePercentage,color:r.oneCustomColors,format:n.oneFormat,"stroke-width":3},null,8,["percentage","color","format"])])),_:1}),(0,l.Wm)(c,{span:6,offset:1},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{percentage:r.twoPercentage,color:r.twoCustomColors,format:n.twoFormat,"stroke-width":3},null,8,["percentage","color","format"])])),_:1}),(0,l.Wm)(c,{span:6,offset:1},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{percentage:r.ThreePercentage,color:r.ThreeCustomColors,format:n.ThreeFormat,"stroke-width":3},null,8,["percentage","color","format"])])),_:1}),(0,l.Wm)(c,{span:2,offset:1,style:{"line-height":"15px"}},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(r.content),1)])),_:1})])),_:1})])}var Wa={name:"PasswordStrength",model:{event:"change",prop:"passwordStr"},props:{passwordStr:{type:[String,Boolean,Number,Object],required:!0,default:""}},watch:{passwordStr(e){const t=this.checkPasswordStrength(e);switch(t){case 0:this.content="",this.onePercentage=0,this.twoPercentage=0,this.ThreePercentage=0;break;case 1:this.content="弱",this.onePercentage=100,this.twoPercentage=0,this.ThreePercentage=0;break;case 2:this.content="中",this.onePercentage=100,this.twoPercentage=100,this.ThreePercentage=0;break;case 3:this.content="中",this.onePercentage=100,this.twoPercentage=100,this.ThreePercentage=0;break;default:this.content="高",this.onePercentage=100,this.twoPercentage=100,this.ThreePercentage=100;break}}},data(){return{content:"",onePercentage:0,twoPercentage:0,ThreePercentage:0,oneCustomColors:[{color:"#f56c6c",percentage:100}],twoCustomColors:[{color:"#e6a23c",percentage:100}],ThreeCustomColors:[{color:"#67c23a",percentage:100}]}},methods:{oneFormat(){return""},twoFormat(){return""},ThreeFormat(){return""},checkPasswordStrength(e){let t=0;return e.length<1||(/\d/.test(e)&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/\W/.test(e)&&t++),t}}};const xa=(0,ie.Z)(Wa,[["render",ka]]);var Ca=xa,Sa={name:"UserAccountRegisterView",components:{ContentField:$t,SliderVerify:ga,PasswordStrength:Ca},setup(){const e=(0,x.oR)(),t=(0,D.iH)(null);let s=(0,D.qj)({username:"",password:"",password_confirm:"",isLock:!1});const a=async()=>{const a=(0,D.SU)(t);await a.validate((t=>{!1!==s.isLock?t&&Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/register/",type:"post",data:s,success(t){"success"===t.result?e.dispatch("login",{username:s.username,password:s.password,success(){(0,Ks.z8)({showClose:!0,message:"登录成功！",type:"success"}),e.dispatch("getinfo",{success(){qa.push({name:"home"})}})}}):(0,Ks.z8)({showClose:!0,message:t.result,type:"error"})}}):(0,Ks.z8)({showClose:!0,message:"请拖动滑块完成验证",type:"error"})}))},l=async e=>{if(e){""!==s.username&&""!==s.password&&""!==s.password_confirm&&s.username&&s.password&&s.password_confirm||(0,Ks.z8)({showClose:!0,message:"请先输入用户名密码！",type:"error"}),s.isLock=!0;const e=(0,D.SU)(t);await e.validateField("isLock")}},o=(e,t,a)=>{if(!t)return a(new Error("请拖动滑块完成验证"));""!==s.username&&""!==s.password&&""!==s.password_confirm&&s.username&&s.password&&s.password_confirm||setTimeout((()=>(s.isLock=!1,s.validateField("username"),s.validateField("password"),s.validateField("password_confirm"),a(new Error("验证未通过")))),1),a()};return{ruleForm:t,register_info:s,register:a,handlerLock:l,rules:{username:[{required:!0,message:"用户名称不得为空！",trigger:"blur"},{min:3,max:18,message:"长度在 3 到 18 个字符",trigger:"blur"}],password:[{required:!0,message:"密码不得为空！",trigger:"blur"},{min:6,max:18,message:"长度在 6 到 18 个字符",trigger:"blur"}],password_confirm:[{required:!0,message:"确认密码不得为空！",trigger:"blur"},{min:6,max:18,message:"长度在 6 到 18 个字符",trigger:"blur"}],isLock:[{validator:o,trigger:"blur"}]}}}};const za=(0,ie.Z)(Sa,[["render",va],["__scopeId","data-v-60550ce9"]]);var Va=za,Ia={state:{id:0,username:"",photo:"",access:"",refresh:"",is_login:!1,pulling_info:!0,interval_func:0},getters:{},mutations:{updateUser(e,t){e.id=t.id,e.username=t.username,e.photo=t.photo,e.is_login=t.is_login},updateToken(e,t){localStorage.setItem("aigame.access",t.access),localStorage.setItem("aigame.refresh",t.refresh),e.access=t.access,e.refresh=t.refresh},logout(e){e.id=0,e.username="",e.photo="",e.access="",e.refresh="",e.is_login=!1},updatePullingInfo(e,t){e.pulling_info=t},setIntervalFunc(e,t){let s=localStorage.getItem("interval_func");null!==s&&clearInterval(s),e.interval_func=t,localStorage.setItem("setIntervalFunc",t)}},actions:{login(e,t){Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/token/",type:"post",data:{username:t.username,password:t.password},success(s){e.commit("updateToken",s),e.dispatch("refresh_access",s.refresh),t.success(s)},error(e){t.error(e)}})},getinfo(e,t){Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/getinfo/",type:"get",headers:{Authorization:"Bearer "+e.state.access},success(s){"success"===s.result?(e.commit("updateUser",{...s,is_login:!0}),t.success()):t.error()},error(e){t.error(e)}})},logout(e){localStorage.removeItem("aigame.access"),localStorage.removeItem("aigame.refresh"),clearInterval(localStorage.getItem("setIntervalFunc")),e.commit("logout")},refresh_access(e,t){let s=setInterval((()=>{Ke().ajax({url:"https://aigame.zzqahm.top/backend/player/token/refresh/",type:"post",data:{refresh:t},success(s){e.commit("updateToken",{access:s.access,refresh:t})},error(e){console.log(e)}})}),27e4);e.commit("setIntervalFunc",s)}},modules:{}},Ua={state:{status:"matching",socket:null,opponent_username:"",opponent_photo:"",gamemap:null,a_id:0,a_sx:0,a_sy:0,b_id:0,b_sx:0,b_sy:0,gameObject:null,loser:"none",type:"none",msgs:[],canSendMsg:!1},getters:{},mutations:{updateSocket(e,t){e.socket=t},updateOpponent(e,t){e.opponent_username=t.username,e.opponent_photo=t.photo},updateStatus(e,t){e.status=t},updateGame(e,t){e.gamemap=t.map,e.a_id=t.a_id,e.a_sx=t.a_sx,e.a_sy=t.a_sy,e.b_id=t.b_id,e.b_sx=t.b_sx,e.b_sy=t.b_sy},updateGameObject(e,t){e.gameObject=t},updateGameResult(e,t){e.loser=t.loser,e.type=t.status},pushMsg(e,t){t.id=e.msgs.length+1,e.msgs.push(t)},clearMsg(e){e.msgs=[]},updateCanSendMsg(e,t){e.canSendMsg=t}},actions:{},modules:{}},ja={state:{hall_socket:null,hall_msgs:[],is_record:!1,a_steps:"",b_steps:"",record_loser:""},getters:{},mutations:{updateHallSocket(e,t){e.hall_socket=t},pushHallMsg(e,t){t.id=e.hall_msgs.length+1,e.hall_msgs.push(t)},updateIsRecord(e,t){e.is_record=t},updateSteps(e,t){e.a_steps=t.a_steps,e.b_steps=t.b_steps},updateRecordLoser(e,t){e.record_loser=t}},actions:{},modules:{}},La=(0,x.MT)({state:{},getters:{},mutations:{},actions:{},modules:{user:Ia,pk:Ua,record:ja}});const Ma=[{path:"/",name:"home",redirect:"/record/",meta:{requestAuth:!0,description:"首页"}},{path:"/pk/:game/",name:"pk_index",component:Ee,meta:{requestAuth:!0,description:"game"}},{path:"/record/",name:"record_index",component:Lt,meta:{requestAuth:!0,description:"对战列表"}},{path:"/record/:recordId/",name:"record_content",component:Dt,meta:{requestAuth:!0,description:"对战界面"}},{path:"/ranklist/",name:"ranklist_index",component:Xe,meta:{requestAuth:!0,description:"排行榜"}},{path:"/discussion/",name:"discussion_index",component:Tt,meta:{requestAuth:!0,description:"讨论区"}},{path:"/message_board/",name:"message_board_index",component:Yt,meta:{requestAuth:!0,description:"留言板"}},{path:"/user/bot/",name:"user_bot_index",component:ea,meta:{requestAuth:!0,description:"我的Bot"}},{path:"/user/account/login/",name:"user_account_login",component:wa,meta:{requestAuth:!1,description:"登录"}},{path:"/user/account/register/",name:"user_account_register",component:Va,meta:{requestAuth:!1,description:"注册"}},{path:"/404/",name:"404",component:oa,meta:{requestAuth:!1,description:""}},{path:"/:catchAll(.*)",redirect:"/404/"}],Ba=(0,C.p7)({history:(0,C.PO)(),routes:Ma});Ba.beforeEach(((e,t,s)=>{e.meta.requestAuth&&!La.state.user.is_login?s({name:"user_account_login"}):s()}));var qa=Ba,Da=s(2748),Fa={name:"App",components:{Expand:Da.Expand,Fold:Da.Fold},setup(){const e=(0,x.oR)(),t=(0,C.yj)(),s=(0,D.iH)("");let a=(0,D.iH)(!1);const o=()=>{e.dispatch("logout"),qa.push({name:"user_account_login"})};(0,l.YP)((()=>t.name),(()=>{s.value=t.meta.description}));const r=()=>{a.value=!a.value};return{logout:o,page:s,collapse:r,isCollapse:a}}};const Oa=(0,ie.Z)(Fa,[["render",W]]);var Pa=Oa,Ha=s(7239);s(4415);const Ea=(0,a.ri)(Pa);Ea.use(Ha.Z);for(const[Aa,$a]of Object.entries(Da))Ea.component(Aa,$a);Ea.use(La).use(qa).mount("#app")}},t={};function s(a){var l=t[a];if(void 0!==l)return l.exports;var o=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=e,function(){s.amdD=function(){throw new Error("define cannot be used indirect")}}(),function(){var e=[];s.O=function(t,a,l,o){if(!a){var r=1/0;for(u=0;u<e.length;u++){a=e[u][0],l=e[u][1],o=e[u][2];for(var n=!0,i=0;i<a.length;i++)(!1&o||r>=o)&&Object.keys(s.O).every((function(e){return s.O[e](a[i])}))?a.splice(i--,1):(n=!1,o<r&&(r=o));if(n){e.splice(u--,1);var c=l();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[a,l,o]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var l,o,r=a[0],n=a[1],i=a[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(l in n)s.o(n,l)&&(s.m[l]=n[l]);if(i)var u=i(s)}for(t&&t(a);c<r.length;c++)o=r[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(u)},a=self["webpackChunkaigame_web"]=self["webpackChunkaigame_web"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(9007)}));a=s.O(a)})();
//# sourceMappingURL=app.bc2b98cc.js.map